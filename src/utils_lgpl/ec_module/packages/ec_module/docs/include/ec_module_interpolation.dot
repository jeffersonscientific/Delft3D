/**
 * @file ec_module_interpolation.dot
 * @brief EC-Module Interpolation Methods
 * @details Detailed view of spatial and temporal interpolation algorithms in EC-Module
 * 
 * To generate diagram in Doxygen, use:
 * @dot
 * digraph ec_interpolation {
 *     // Include this file content
 * }
 * @enddot
 */

digraph ec_module_interpolation {
    // Graph attributes
    rankdir=TB;
    bgcolor="white";
    fontname="Arial";
    fontsize=12;
    
    // INTERACTIVE FEATURES: All boxes contain clickable links (URL attributes) 
    // that navigate directly to relevant source code files in the repository.
    // Use with Doxygen or GraphViz tools that support URL navigation.
    
    // Node styling
    node [shape=box, style=filled, fontname="Arial", fontsize=9];
    edge [fontname="Arial", fontsize=8];
    
    // Input data types
    subgraph cluster_input {
        label="Input Data Types";
        style=filled;
        fillcolor="lightgray";
        
        point_data [label="Point Data\nMeteorological Stations\nBoundary Points\nObservation Data", fillcolor="lightblue", URL="../../../../../../examples/"];
        grid_data [label="Grid Data\nRegular Grids\nCurvilinear Grids\nUnstructured Meshes", fillcolor="lightgreen", URL="../../../../../../examples/"];
        time_series [label="Time Series\nTemporal Sequences\nMulti-dimensional\nVariable Time Steps", fillcolor="lightyellow", URL="../../../../../../examples/"];
    }
    
    // Spatial interpolation methods
    subgraph cluster_spatial {
        label="Spatial Interpolation Methods";
        style=filled;
        fillcolor="orange";
        
        triangulation [label="Triangulation\nDelaunay Triangulation\nBarycentric Coordinates\nNatural Neighbors", fillcolor="orange", URL="../../src/ec_basic_interpolation.f90"];
        bilinear [label="Bilinear Interpolation\nGrid-based\nFour-point\nRectangular Cells", fillcolor="orange", URL="../../src/ec_basic_interpolation.f90"];
        nearest [label="Nearest Neighbor\nKD-Tree Search\nVoronoi Cells\nDistance-based", fillcolor="orange", URL="../../../../../../third_party_open/kdtree2"];
        averaging [label="Spatial Averaging\nWeighted Average\nInverse Distance\nGaussian Kernel", fillcolor="orange", URL="../../src/ec_basic_interpolation.f90"];
    }
    
    // Temporal interpolation
    subgraph cluster_temporal {
        label="Temporal Interpolation";
        style=filled;
        fillcolor="green";
        
        linear_time [label="Linear Interpolation\nTime-weighted\nPiecewise Linear\nContinuous", fillcolor="lightgreen", URL="../../src/ec_field.f90"];
        block_time [label="Block Function\nConstant Intervals\nStep-wise\nNearest Time", fillcolor="lightgreen", URL="../../src/ec_field.f90"];
        harmonic_time [label="Harmonic Analysis\nTidal Components\nFourier Series\nPhase-amplitude", fillcolor="lightgreen", URL="../../../../../../third_party_open/spherepack"];
    }
    
    // Coordinate transformations
    subgraph cluster_coordinates {
        label="Coordinate Systems";
        style=filled;
        fillcolor="purple";
        
        cartesian [label="Cartesian\nX-Y Coordinates\nLocal Projection\nMetric System", fillcolor="lightcoral", URL="../../../../../../utils_lgpl/gridgeom"];
        spherical [label="Spherical\nLat-Lon Coordinates\nGeographic System\nWGS84", fillcolor="lightcoral", URL="../../../../../../utils_lgpl/gridgeom"];
        curvilinear [label="Curvilinear\nBody-fitted\nOrthogonal\nNon-orthogonal", fillcolor="lightcoral", URL="../../../../../../utils_lgpl/gridgeom"];
    }
    
    // Algorithm implementations
    subgraph cluster_algorithms {
        label="Core Algorithms";
        style=filled;
        fillcolor="red";
        
        delaunay [label="Delaunay Algorithm\nTriangle Generation\nCircumcircle Test\nEdge Flipping", fillcolor="red", fontcolor="white", URL="../../../../../../third_party_open/triangle"];
        kdtree_alg [label="KD-Tree Algorithm\nSpace Partitioning\nBalanced Tree\nRange Search", fillcolor="red", fontcolor="white", URL="../../../../../../third_party_open/kdtree2"];
        polygon_alg [label="Polygon Algorithm\nPoint-in-Polygon\nClipping\nIntersection", fillcolor="red", fontcolor="white", URL="../../../../../../third_party_open/polypack"];
        transformation [label="Coordinate Transform\nProjection\nRotation\nScaling", fillcolor="red", fontcolor="white", URL="../../../../../../utils_lgpl/gridgeom"];
    }
    
    // Target applications
    subgraph cluster_targets {
        label="Target Applications";
        style=filled;
        fillcolor="yellow";
        
        meteo_forcing [label="Meteorological Forcing\nWind Fields\nPressure\nTemperature\nHumidity", fillcolor="yellow", URL="../../../../../../engines_gpl/dflowfm/packages/dflowfm_kernel/src/dflowfm_kernel/timespace/meteo1.f90"];
        boundary_cond [label="Boundary Conditions\nWater Levels\nDischarges\nConcentrations", fillcolor="yellow", URL="../../../../../../engines_gpl/dflowfm/packages/dflowfm_kernel/src/dflowfm_kernel/externals"];
        initial_cond [label="Initial Conditions\nField Initialization\nRestart Data\nSpin-up", fillcolor="yellow", URL="../../../../../../engines_gpl/dflowfm/packages/dflowfm_kernel/src/dflowfm_kernel/prepost"];
        coupling_data [label="Model Coupling\nInter-model Data\nFeedback\nSynchronization", fillcolor="yellow", URL="../../../../../../engines_gpl/dimr"];
    }
    
    // Data flow connections
    
    // Input to spatial methods
    point_data -> triangulation [label="scattered points"];
    point_data -> nearest [label="station data"];
    grid_data -> bilinear [label="regular grid"];
    grid_data -> averaging [label="grid cells"];
    
    // Spatial to temporal
    triangulation -> linear_time [label="interpolated field"];
    bilinear -> block_time [label="grid values"];
    nearest -> harmonic_time [label="point values"];
    averaging -> linear_time [label="averaged field"];
    
    // Coordinate transformations
    cartesian -> triangulation [label="local coords"];
    spherical -> bilinear [label="geo coords"];
    curvilinear -> averaging [label="curved grid"];
    
    // Algorithm implementations
    delaunay -> triangulation [label="implements"];
    kdtree_alg -> nearest [label="implements"];
    polygon_alg -> averaging [label="implements"];
    transformation -> cartesian [label="converts to"];
    transformation -> spherical [label="converts to"];
    transformation -> curvilinear [label="converts to"];
    
    // Time series input
    time_series -> linear_time [label="temporal data"];
    time_series -> block_time [label="step data"];
    time_series -> harmonic_time [label="periodic data"];
    
    // Output to applications
    linear_time -> meteo_forcing [label="time-varying"];
    block_time -> boundary_cond [label="constant periods"];
    harmonic_time -> initial_cond [label="periodic initial"];
    
    triangulation -> coupling_data [label="spatial coupling"];
    bilinear -> meteo_forcing [label="gridded meteo"];
    nearest -> boundary_cond [label="point boundaries"];
    averaging -> coupling_data [label="area coupling"];
    
    // Quality control and validation
    validation [label="Quality Control\n|{Range Checking|Consistency|Missing Data}", shape=ellipse, fillcolor="cyan"];
    
    linear_time -> validation [style=dashed, label="validate"];
    triangulation -> validation [style=dashed, label="validate"];
    bilinear -> validation [style=dashed, label="validate"];
    
    // Title
    labelloc="t";
    label="EC-Module Interpolation Methods and Algorithms";
}